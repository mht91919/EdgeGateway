<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="./flexible.js"></script>
    <script type="text/javascript" src="./jquery.js"></script>
    <script type="text/javascript" src="./common.js"></script>
    <link rel="stylesheet" type="text/css" href="./common.css" />
    <link rel="stylesheet" type="text/css" href="./index.css" />
    <script type="text/javascript">

        $(document).ready(function () {
            setInterval(myfunction, 1000);
            setInterval(getTime, 1000);


            //getDeviceInitConnect();
            //getDeviceRealConnect();

            getDevice();
            getControl();

            $('#resTextExit').click(funExit);


        });

        function getTime() {

            $('#resTextTime').html(new Date().toLocaleTimeString());

            $('#resTextDate').html(new Date().toLocaleDateString() + '&nbsp;' + getWeek());
        }


        function checkclick() {

            $.ajax({
                method: 'get',
                url: "/api/setAgreeStatus",//路径，就是你要交互的后台的路径
                success: function (data) {    //交互成功后的回调函数，data为返回的内容
                },
                error: function (data) {
                    console.log(data);
                }
            })

            var checkimg = document.getElementById("checkimg");
            if ($("#agree").is(':checked')) {
                $("#agree").attr("checked", "unchecked");
                checkimg.src = "./img/mute.png";
                $("#resSilence").css('display', '');
                $("#resMute").css('display', 'none');
            }
            else {
                $("#agree").attr("checked", "checked");
                checkimg.src = "./img/SketchPnge1389b91eaa2f2aa35899e1ecb63d6c1376b820d9d58ca8609dff81f9bd2e362.png";
                $("#resMute").css('display', '');
                $("#resSilence").css('display', 'none');
            }
        }

        function getControl() {
            var p;

            $.ajax({
                type: "Get",//提交方式，分为get和post两种
                url: "/api/getControl",//路径，就是你要交互的后台的路径
                async: false,
                success: function (data) {    //交互成功后的回调函数，data为返回的内容
                    p = data;
                },
                error: function (data) {

                    console.log("getControl Error");
                }
            })

            var parameter = JSON.parse(p);

            return parameter;
        }

        function getDevice() {
            var parameter;

            $.ajax({
                type: "Get",//提交方式，分为get和post两种
                url: "/api/GetDevice",//路径，就是你要交互的后台的路径
                async: false,
                success: function (data) {    //交互成功后的回调函数，data为返回的内容
                    $('#resTextDeviceNo').html(data);
                    parameter = data;
                },
                error: function (data) {

                    console.log("getDevice Error");
                }
            })

            return parameter;
        }

        function getAgreeStatus() {

            $.ajax({
                method: 'get',
                url: "/api/getAgreeStatus",//路径，就是你要交互的后台的路径

                error: function (data) {
                    console.log(data);
                }
            })
        }

        function funExit() {
            console.log("退出");
            $.ajax({
                method: 'get',
                url: "/api/exit",//路径，就是你要交互的后台的路径

                error: function (data) {
                    console.log(data);
                }
            })
        }


        //获取设备实时状态
        function getDeviceRealConnect() {

            var resTextDeviceNo = getDevice();//获取已绑定的设备编号

            var parameter = getControl();

            var rescheckDeviceConnect = document.getElementById("rescheckDeviceConnect");

            if (!window.WebSocket) {
                if (window.MozWebSocket) {
                    window.WebSocket = window.MozWebSocket;
                } else {
                    $('#resTextDeviceNo').prepend("<p>你的浏览器不支持websocket</p>");
                }
            }

            var wsConnect = new WebSocket(parameter.getDeviceRealConnect);

            wsConnect.onopen = function (evt) {
                console.log("建立连接");
                wsConnect.send("{\"cmd\":\"sub\",\"topic\":\"all_device_state\"}");

            }
            wsConnect.onclose = function (evt) {
                console.log('连接关闭')
                wsConnect.send("{\"cmd\":\"cancel\",\"topic\":\"all_device_state\"}");
            }

            wsConnect.onmessage = function (evt) {

                console.log(JSON.parse(evt.data));

                var resrecord = JSON.parse(evt.data).data;

                var uniqueArray = resrecord.filter(i => i.deviceCode.split("-")[0] === resTextDeviceNo)

                if (uniqueArray != null) {

                    let flag = uniqueArray.every(i => i.online == 1)

                    if (flag) {

                        console.log(flag)

                        $('#rescheckDeviceConnect').attr("src", "./img/open.png");
                        if (rescheckDeviceConnect.style.visibility == 'hidden') {
                            rescheckDeviceConnect.style.visibility = 'visible';
                        }
                    }
                    else {
                        $('#rescheckDeviceConnect').attr("src", "./img/close.png");
                    }
                }

                console.log(uniqueArray);

            }

            wsConnect.onerror = function () {
                // notify.warn("websocket通信发生错误！");
                // initWebSocket()
            }

            wsConnect.onbeforeunload = function () {
                wsConnect.close();
            }
        }

        function myfunction() {

            $.ajax({
                type: "Get",//提交方式，分为get和post两种
                url: "/api/getTaskInfoNew",//路径，就是你要交互的后台的路径

                success: function (res) {    //交互成功后的回调函数，data为返回的内容

                    //如果任务存在
                    if (res.HasTask === true) {

                        console.log("任务存在");

                        if (res.TaskInfo !== undefined) {

                            console.log("任务存在并且有值");

                            $('#_task').show();//任务显示

                            $('#_tasknone').hide();//无任务隐藏

                            var taskInfo = res.TaskInfo;

                            if (taskInfo.IsCalcWeldModeequal) {
                                $('#_alert').show();
                            }
                            else {
                                $('#_alert').hide();
                            }

                            console.log("存在任务，任务状态是（0脉冲，1恒流）：" + taskInfo.weld_mode);

                            //console.log("采集到的脉冲电流阈值：" + taskInfo.current_base);
                            //console.log("采集到的脉冲电流阈值：" + taskInfo.current_peak);
                            //console.log("采集到的脉冲电压阈值：" + taskInfo.voltage_base);
                            //console.log("采集到的脉冲电压阈值：" + taskInfo.voltage_peak);
                                                 
                            //console.log("采集到的恒流电流阈值：" + taskInfo.current_min);
                            //console.log("采集到的恒流电流阈值：" + taskInfo.current_max);
                            //console.log("采集到的恒流电压阈值：" + taskInfo.voltage_min);
                            //console.log("采集到的恒流电压阈值：" + taskInfo.voltage_max);

                            console.log("模式是否一致（如果结果true，那么就显示这几个字）：" + taskInfo.IsCalcWeldModeequal);


                            $("#current_base").html(taskInfo.current_base);//电流脉冲基值最小值
                            $('#current_peak').html(taskInfo.current_peak);//电流脉冲峰值最大值
                            $('#voltage_base').html(taskInfo.voltage_base);//电压脉冲基值最小值
                            $('#voltage_peak').html(taskInfo.voltage_peak);//电压脉冲峰值最大值

                            $("#current_min").html(taskInfo.current_min);//电流恒流基值最小值
                            $('#current_max').html(taskInfo.current_max);//电流恒流峰值最大值
                            $('#voltage_min').html(taskInfo.voltage_min);//电压恒流基值最小值
                            $('#voltage_max').html(taskInfo.voltage_max);//电压恒流峰值最大值


                            //脉冲
                            if (taskInfo.weld_mode !== undefined && taskInfo.weld_mode != null && taskInfo.weld_mode === "0") {


                                $('#hengliuCurrent').hide();//恒流电流隐藏
                                $('#hengliuVoltage').hide();//恒流电压隐藏

                                $('#maichongCurrent').show();//脉冲电流显示
                                $('#maichongVoltage').show();//脉冲电压显示


                                $('#resModel').html("脉冲模式");//脉冲模式
                                $('#resModelImage').attr("src", "./img/SketchPngd018a0dc2d50124dac3dbbde03ccf20afc2dfe3031d6b828021e677b5eac49e5.png");

                            }
                            //恒流
                            else {

                                $('#maichongCurrent').hide();//脉冲电流隐藏
                                $('#maichongVoltage').hide();//脉冲电压隐藏

                                $('#hengliuCurrent').show();//脉冲电流显示
                                $('#hengliuVoltage').show();//脉冲电压显示


                                $('#resModel').html("恒流模式");//恒流模式
                                $('#resModelImage').attr("src", "./img/SketchPngdf03b8c621c3041b89673428198bbc54085646e9f14a380adb0738386e7e07f3.png");
                            }

                            $('#st_no').html(taskInfo.st_no);//流转卡号
                            $('#op_no').html(taskInfo.op_no);//工序号
                            $('#op_content').html(taskInfo.op_content);//工序内容
                            $('#op_remarks').html(taskInfo.op_remarks);//工序备注


                            $('#weld_code').html(taskInfo.weld_code);//焊缝代号
                            $('#weld_type').html(taskInfo.weld_type);//焊缝类型
                            $('#operator_type').html(taskInfo.operator_type);//人员类型

                            $('#wo_no').html(taskInfo.wo_no);//WPS编号
                            $('#wps_code').html(taskInfo.wps_code);//WPS编号
                            $('#classes').html(taskInfo.classes);//班次
                            
                            $('#task_sort').html(taskInfo.task_sort);//任务分离
                            $('#weld_method').html(taskInfo.weld_method);//焊接方法
                            $('#task_sort').html(taskInfo.weld_layer);//焊层/道

                            $('#remarks').html(taskInfo.remarks);//备注

                            $('#task_create_time').html(taskInfo.task_create_time);//创建时间
                            $('#task_updte_time').html(taskInfo.task_updte_time);//更新时间
                            
                            
                        }
                        else {
                            $('#_task').hide();//任务隐藏
                            $('#_tasknone').show();//无任务显示

                            console.log("没有任务");

                            $('#_alert').hide();

                            //没有任务，取采集的焊接模式
                            if (res.CVWMInfo !== undefined) {
                                var CVWMInfo = res.CVWMInfo;

                                console.log("没有任务，算法给的焊接模式（0脉冲，1恒流）：" + CVWMInfo.calcWeldMode)
                                //如果采集的模式不为空
                                if (CVWMInfo.calcWeldMode != undefined) {
                                    //脉冲
                                    if (CVWMInfo.calcWeldMode === "0") {

                                        $('#hengliuCurrent').hide();//恒流电流隐藏
                                        $('#hengliuVoltage').hide();//恒流电压隐藏

                                        $('#maichongCurrent').show();//脉冲电流显示
                                        $('#maichongVoltage').show();//脉冲电压显示

                                        $('#resModel').html("脉冲模式");//脉冲模式
                                        $('#resModelImage').attr("src", "./img/SketchPngd018a0dc2d50124dac3dbbde03ccf20afc2dfe3031d6b828021e677b5eac49e5.png");

                                    }
                                    //恒流
                                    else {
                                        $('#maichongCurrent').hide();//脉冲电流隐藏
                                        $('#maichongVoltage').hide();//脉冲电压隐藏


                                        $('#hengliuCurrent').show();//脉冲电流显示
                                        $('#hengliuVoltage').show();//脉冲电压显示


                                        $('#resModel').html("恒流模式");//恒流模式
                                        $('#resModelImage').attr("src", "./img/SketchPngdf03b8c621c3041b89673428198bbc54085646e9f14a380adb0738386e7e07f3.png");

                                    }
                                }
                            }
                        }
                    }
                    //任务不存在
                    else {

                        $('#_task').hide();//任务隐藏
                        $('#_tasknone').show();//无任务显示


                        $("#current_base").html(null);//电流脉冲基值最小值
                        $('#current_peak').html(null);//电流脉冲峰值最大值
                        $('#voltage_base').html(null);//电压脉冲基值最小值
                        $('#voltage_peak').html(null);//电压脉冲峰值最大值

                        $("#current_min").html(null);//电流恒流基值最小值
                        $('#current_max').html(null);//电流恒流峰值最大值
                        $('#voltage_min').html(null);//电压恒流基值最小值
                        $('#voltage_max').html(null);//电压恒流峰值最大值


                        $('#_alert').hide();

                        //没有任务，取采集的焊接模式
                        if (res.CVWMInfo !== undefined) {

                            var CVWMInfo = res.CVWMInfo;

                            //如果采集的模式不为空
                            if (CVWMInfo.calcWeldMode != undefined) {

                                console.log("没有任务的情况下，采集的焊机模式（0脉冲，1恒流）:" + CVWMInfo.calcWeldMode)

                                //脉冲
                                if (CVWMInfo.calcWeldMode === "0") {

                                    $('#hengliuCurrent').hide();//恒流电流隐藏
                                    $('#hengliuVoltage').hide();//恒流电压隐藏

                                    $('#maichongCurrent').show();//脉冲电流显示
                                    $('#maichongVoltage').show();//脉冲电压显示

                                    $('#resModel').html("脉冲模式");//脉冲模式
                                    $('#resModelImage').attr("src", "./img/SketchPngd018a0dc2d50124dac3dbbde03ccf20afc2dfe3031d6b828021e677b5eac49e5.png");
                                }
                                //恒流
                                else {

                                    $('#maichongCurrent').hide();//脉冲电流隐藏
                                    $('#maichongVoltage').hide();//脉冲电压隐藏


                                    $('#hengliuCurrent').show();//脉冲电流显示
                                    $('#hengliuVoltage').show();//脉冲电压显示


                                    $('#resModel').html("恒流模式");//恒流模式
                                    $('#resModelImage').attr("src", "./img/SketchPngdf03b8c621c3041b89673428198bbc54085646e9f14a380adb0738386e7e07f3.png");
                                }
                            }
                            //如果采集的模式为空，那么显示脉冲的
                            else {

                                $('#hengliuCurrent').hide();//恒流电流隐藏
                                $('#hengliuVoltage').hide();//恒流电压隐藏

                                $('#maichongCurrent').show();//脉冲电流显示
                                $('#maichongVoltage').show();//脉冲电压显示

                                $('#resModel').html("脉冲模式");//脉冲模式
                                $('#resModelImage').attr("src", "./img/SketchPngd018a0dc2d50124dac3dbbde03ccf20afc2dfe3031d6b828021e677b5eac49e5.png");
                            }
                        }
                        //如果采集也停了（显示脉冲的）
                        else {

                            console.log("没有任务,采集也停了的情况下");

                            $('#hengliuCurrent').hide();//恒流电流隐藏
                            $('#hengliuVoltage').hide();//恒流电压隐藏

                            $('#maichongCurrent').show();//脉冲电流显示
                            $('#maichongVoltage').show();//脉冲电压显示

                            $('#resModel').html("脉冲模式");//脉冲模式
                            $('#resModelImage').attr("src", "./img/SketchPngd018a0dc2d50124dac3dbbde03ccf20afc2dfe3031d6b828021e677b5eac49e5.png");
                        }
                    }

                    //如果平台状态能抓到
                    if (res.IOTConnectInfo !== undefined) {

                        var th = undefined;

                        var rescheckIOTConnect = document.getElementById("rescheckIOTConnect");

                        if (res.IOTConnectInfo.result !== undefined && res.IOTConnectInfo.result === true) {

                            clearInterval(th);


                            $('#rescheckIOTConnect').attr("src", "./img/open.png");
                        }
                        //获取到的状态是False
                        else {

                            console.log("IOTResultError：" + res.IOTConnectInfo.result);

                            $('#rescheckIOTConnect').attr("src", "./img/close.png");

                            //th = setInterval(function () {


                            //    if (rescheckIOTConnect.style.visibility == 'hidden') {
                            //        rescheckIOTConnect.style.visibility = 'visible';
                            //    } else {
                            //        rescheckIOTConnect.style.visibility = 'hidden';
                            //    }
                            //}, 1000);
                        }
                    }

                    //电流电压焊接模式
                    if (res.CVWMInfo !== undefined) {

                        var CVWMInfo = res.CVWMInfo;

                        //脉冲峰值电流
                        if (CVWMInfo.maxCurrent !== undefined && CVWMInfo.maxCurrent != null) {

                            var maxCurrent = convert_to_float(CVWMInfo.maxCurrent).toFixed(1);
                        }
                        else {
                            var maxCurrent = 0.0;
                        }

                        //脉冲基值电流
                        if (CVWMInfo.minCurrent !== undefined && CVWMInfo.minCurrent != null) {
                            var minCurrent = convert_to_float(CVWMInfo.minCurrent).toFixed(1);
                        }
                        else {
                            var minCurrent = 0.0;
                        }
                        //脉冲峰值电压
                        if (CVWMInfo.maxVoltage !== undefined && CVWMInfo.maxVoltage != null) {
                            var maxVoltage = convert_to_float(CVWMInfo.maxVoltage).toFixed(1);
                        }
                        else {
                            var maxVoltage = 0.0;
                        }

                        //脉冲基值电压
                        if (CVWMInfo.minVoltage !== undefined && CVWMInfo.minVoltage != null) {
                            var minVoltage = convert_to_float(CVWMInfo.minVoltage).toFixed(1);
                        }
                        else {
                            var minVoltage = 0.0;
                        }

                        //恒流电流
                        if (CVWMInfo.medianCurrent !== undefined && CVWMInfo.medianCurrent != null) {
                            var medianCurrent = convert_to_float(CVWMInfo.medianCurrent).toFixed(1);
                        }
                        else {
                            var medianCurrent = 0.0;
                        }

                        //恒流电压
                        if (CVWMInfo.medianVoltage !== undefined && CVWMInfo.medianVoltage != null) {
                            var medianVoltage = convert_to_float(CVWMInfo.medianVoltage).toFixed(1);
                        }
                        else {
                            var medianVoltage = 0.0;
                        }

                        //脉冲峰值电流
                        var stringmaxCurrent = maxCurrent.toString();
                        var nummaxCurrent = parseInt(stringmaxCurrent.substring(0, stringmaxCurrent.indexOf('.')));
                        var decmaxCurrent = stringmaxCurrent.replace(/\d+\.(\d*)/, '$1')

                        //脉冲基值电流
                        var stringminCurrent = minCurrent.toString();
                        var numminCurrent = parseInt(stringminCurrent.substring(0, stringminCurrent.indexOf('.')));
                        var decminCurren = stringminCurrent.replace(/\d+\.(\d*)/, '$1')

                        //脉冲峰值电压
                        var stringmaxVoltage = maxVoltage.toString();
                        var nummaxVoltage = parseInt(stringmaxVoltage.substring(0, stringmaxVoltage.indexOf('.')));
                        var decmaxVoltage = stringmaxVoltage.replace(/\d+\.(\d*)/, '$1')

                        //脉冲基值电压
                        var stringminVoltage = minVoltage.toString();
                        var numminVoltage = parseInt(stringminVoltage.substring(0, stringminVoltage.indexOf('.')));
                        var decminVoltage = stringminVoltage.replace(/\d+\.(\d*)/, '$1')

                        //恒流电流
                        var stringmedianCurrent = medianCurrent.toString();
                        var nummedianCurrent = parseInt(stringmedianCurrent.substring(0, stringmedianCurrent.indexOf('.')));
                        var decmedianCurrent = stringmedianCurrent.replace(/\d+\.(\d*)/, '$1');

                        //恒流电压
                        var stringmedianVoltage = medianVoltage.toString();
                        var nummedianVoltage = parseInt(stringmedianVoltage.substring(0, stringmedianVoltage.indexOf('.')));
                        var decmedianVoltage = stringmedianVoltage.replace(/\d+\.(\d*)/, '$1');

                        $('#resCurrentPeakInteger').html(nummaxCurrent);
                        $('#resCurrentPeakDecimal').html("." + decmaxCurrent);

                        $('#resCurrentBaseInteger').html(numminCurrent);
                        $('#resCurrentBaseDecimal').html("." + decminCurren);


                        $('#resVoltagePeakInteger').html(nummaxVoltage);
                        $('#resVoltagePeakDecimal').html("." + decmaxVoltage);

                        $('#resVoltageBaseInteger').html(numminVoltage);
                        $('#resVoltageBaseDecimal').html("." + decminVoltage);


                        $('#reshengliuAinteger').html(nummedianCurrent);
                        $('#reshengliuAintegerDecimal').html("." + decmedianCurrent);

                        $('#reshengliuVinteger').html(nummedianVoltage);
                        $('#reshengliuVintegerDecimal').html("." + decmedianVoltage);

                        console.log("采集到的脉冲电流峰值：" + stringmaxCurrent);
                        console.log("采集到的脉冲电流基值：" + stringminCurrent);
                        console.log("采集到的脉冲电压峰值：" + stringmaxVoltage);
                        console.log("采集到的脉冲电压基值：" + stringminVoltage);

                        console.log("采集到的恒流电流：" + stringmedianCurrent);
                        console.log("采集到的恒流电压：" + stringmedianVoltage);

                        //脉冲电流峰值
                        if (CVWMInfo.maxCurrentexceed) {

                            document.getElementById("resCurrentPeakInteger").style.color = "rgba(255, 15, 51, 1)";
                            document.getElementById("resCurrentPeakDecimal").style.color = "rgba(255, 15, 51, 1)";
                        }
                        else {

                            document.getElementById("resCurrentPeakInteger").style.color = null;
                            document.getElementById("resCurrentPeakDecimal").style.color = null;
                        }

                        //脉冲电流基值
                        if (CVWMInfo.minCurrentexceed) {
                            document.getElementById("resCurrentBaseInteger").style.color = "rgba(255, 15, 51, 1)";
                            document.getElementById("resCurrentBaseDecimal").style.color = "rgba(255, 15, 51, 1)";
                        }
                        else {
                            document.getElementById("resCurrentBaseInteger").style.color = null;
                            document.getElementById("resCurrentBaseDecimal").style.color = null;

                        }
                        //脉冲脉冲电压峰值
                        if (CVWMInfo.maxVoltageexceed) {

                            document.getElementById("resVoltagePeakInteger").style.color = "rgba(255, 15, 51, 1)";
                            document.getElementById("resVoltagePeakDecimal").style.color = "rgba(255, 15, 51, 1)";
                        }
                        else {
                            document.getElementById("resVoltagePeakInteger").style.color = null;
                            document.getElementById("resVoltagePeakDecimal").style.color = null;
                        }
                        //脉冲电压基值
                        if (CVWMInfo.minVoltageexceed) {
                            document.getElementById("resVoltageBaseInteger").style.color = "rgba(255, 15, 51, 1)";
                            document.getElementById("resVoltageBaseDecimal").style.color = "rgba(255, 15, 51, 1)";
                        }
                        else {
                            document.getElementById("resVoltageBaseInteger").style.color = null;
                            document.getElementById("resVoltageBaseDecimal").style.color = null;

                        }
                        //恒流，埋弧焊电流
                        if (CVWMInfo.medianCurrentexceed) {
                            document.getElementById("reshengliuAinteger").style.color = "rgba(255, 15, 51, 1)";
                            document.getElementById("reshengliuAintegerDecimal").style.color = "rgba(255, 15, 51, 1)";
                        }
                        else {
                            document.getElementById("reshengliuAinteger").style.color = null;
                            document.getElementById("reshengliuAintegerDecimal").style.color = null;
                        }
                        //恒流，埋弧焊电压
                        if (CVWMInfo.medianVoltageexceed) {
                            document.getElementById("reshengliuVinteger").style.color = "rgba(255, 15, 51, 1)";
                            document.getElementById("reshengliuVintegerDecimal").style.color = "rgba(255, 15, 51, 1)";
                        }
                        else {
                            document.getElementById("reshengliuVinteger").style.color = null;
                            document.getElementById("reshengliuVintegerDecimal").style.color = null;
                        }
                    }
                    //报警消音按钮状态
                    if (res.MuteInfo !== undefined) {
                        var MuteInfo = res.MuteInfo;

                        var checkimg = document.getElementById("checkimg");

                        //报警开启
                        if (MuteInfo.Mute) {

                            $("#agree").attr("checked", "unchecked");
                            checkimg.src = "./img/mute.png";
                            $("#resSilence").css('display', '');
                            $("#resMute").css('display', 'none');
                        }
                        //报警关闭状态
                        else {

                            $("#agree").attr("checked", "checked");
                            checkimg.src = "./img/SketchPnge1389b91eaa2f2aa35899e1ecb63d6c1376b820d9d58ca8609dff81f9bd2e362.png";
                            $("#resMute").css('display', '');
                            $("#resSilence").css('display', 'none');
                        }
                    }

                    //设备连接状态
                    if (res.DeviceConnectInfo !== undefined) {

                        var th = undefined;

                        var DeviceConnectInfo = res.DeviceConnectInfo;

                        var rescheckDeviceConnect = document.getElementById("rescheckDeviceConnect");


                        if (DeviceConnectInfo.online !== undefined && DeviceConnectInfo.online) {

                            clearInterval(th);

                            $('#rescheckDeviceConnect').attr("src", "./img/open.png");
                        }
                        else {

                            $('#rescheckDeviceConnect').attr("src", "./img/close.png");

                            //th = setInterval(function () {

                            //    if (rescheckDeviceConnect.style.visibility == 'hidden') {
                            //        rescheckDeviceConnect.style.visibility = 'visible';
                            //    } else {
                            //        rescheckDeviceConnect.style.visibility = 'hidden';
                            //    }
                            //}, 1000);
                        }

                    }
                },
                error: function (data) {

                    console.log("myfunction Error");
                }
            })
        }
    </script>
</head>
<body>
    <div class="page flex-col">
        <div class="group_1 flex-col">
            <div class="group_2 flex-col">
                <div class="section_4 flex-row">
                    <img class="image_1"
                         referrerpolicy="no-referrer"
                         src="./img/SketchPng6e2dfcef8cfe5d3e9ec4e6f4b2a720c1e8cab0a396153203f3d57740fde4fe88.png" />
                    <img class="image_2"
                         referrerpolicy="no-referrer"
                         src="./img/SketchPng09261018837d69c72a9a5aa06e008a0eda96bdf9b831a2135672889c0c9f4310.png" />
                    <span class="text_1">东重边缘计算系统</span>
                    <div class="text-wrapper_11 flex-col justify-between">
                        <span class="text_2" id="resTextTime"></span>
                        <span class="text_3" id="resTextDate"></span>
                    </div>
                    <img class="image_3"
                         referrerpolicy="no-referrer"
                         src="./img/SketchPng24d6b09c91d8e8d6582ac89048d799e37c416a25dacd14a7eece8dde733d4d2e.png" />

                    <div class="group_4 flex-row justify-between">
                        <label for="agree" class="label33" onclick="checkclick()">
                            <img class="thumbnail_1" src="img/SketchPnge1389b91eaa2f2aa35899e1ecb63d6c1376b820d9d58ca8609dff81f9bd2e362.png"
                                 referrerpolicy="no-referrer" id="checkimg">
                            <span id="resSilence" class="text_49" style="display:none">报警消音</span>
                            <span id="resMute" class="text_49">开启报警</span>
                        </label>
                        <input type="checkbox" id="agree" checked="checked" style="display:none">


                    </div>
                    <div class="group_5 flex-row justify-between" onclick="funExit()" style="cursor:pointer;">
                        <img class="thumbnail_2"
                             referrerpolicy="no-referrer"
                             src="./img/SketchPng0688e4faba5e9f3396b11ddfed71f33b34cce3f8aa1cee7fd7e451445cabe315.png" />
                        <span class="text_5">退出</span>
                    </div>
                </div>
                <div class="section_5 flex-row justify-between">
                    <div class="box_1 flex-col">

                        <!------------------------------------------------------------>

                        <div class="group_13 flex-row">
                            <img class="image_13"
                                 referrerpolicy="no-referrer"
                                 src="./img/SketchPnge174ed5593b0a085c6fb75ea3d8ccf7ae28743569bbd5b9d6cd20ca19e92ec64.png" />
                            <div class="text-wrapper_12 flex-col justify-between">
                                <span class="text_6">设备编号</span>
                                <span class="text_7" id="resTextDeviceNo"></span>
                            </div>
                            <div class="group_14 flex-row">
                                <span class="text_9" id="resModel"></span>
                                <div class="image-wrapper_1 flex-col">
                                    <img class="thumbnail_9" id="resModelImage"
                                         referrerpolicy="no-referrer"
                                         src="./img/SketchPngd018a0dc2d50124dac3dbbde03ccf20afc2dfe3031d6b828021e677b5eac49e5.png" />
                                </div>
                            </div>
                            <div class="group_15 flex-row">
                                <span class="text_9">平台通讯</span>
                                <div class="image-wrapper_1 flex-col">
                                    <img class="thumbnail_9" id="rescheckIOTConnect"
                                         referrerpolicy="no-referrer"
                                         src="./img/close.png" />
                                </div>
                            </div>
                            <div class="group_16 flex-row">
                                <span class="text_10">设备通讯</span>
                                <div class="image-wrapper_2 flex-col">
                                    <img class="thumbnail_10" id="rescheckDeviceConnect"
                                         referrerpolicy="no-referrer"
                                         src="./img/close.png" />
                                </div>
                            </div>
                        </div>

                        <!------------------------------------------------------------>

                        <div class="block_2 flex-col"></div>

                        <!------------------------------------------------------------>

                        <img class="label_2"
                             referrerpolicy="no-referrer"
                             src="./img/SketchPngb6cdd3b3c3ae842abf9cb3c1a42557bba7f0b3c04d7e468a616395600af01579.png" />

                        <!-----------------------------------------------------------A-->

                        <div id="maichongCurrent">
                            <div class="group_17 flex-row">
                                <div class="image-text_8 flex-row justify-between">
                                    <div class="text-group_8 flex-col justify-between">
                                        <span class="text_111">阈值</span>
                                        <span class="text_11" id="current_base"></span>
                                        <span class="text_12">基值最小值</span>
                                    </div>
                                    <img class="image_5"
                                         referrerpolicy="no-referrer"
                                         src="./img/SketchPngf26d5eaaaaef810a66edefaf4d1b092fa6902e337a61e075a9ae1393ccb8bb45.png" />
                                </div>
                                <span class="text_13">888</span>
                                <span class="text_14" id="resCurrentBaseInteger"></span>
                                <span class="text_15">.8</span>
                                <img class="image_6"
                                     referrerpolicy="no-referrer"
                                     src="./img/SketchPngb46fc42ad5a5468d22aac004395ddb608cbb2a5eb3e78ad02c0887e3b9a9d09a.png" />
                                <span class="text_16">888</span>
                                <span class="text_17" id="resCurrentPeakInteger"></span>
                                <span class="text_18">.8</span>
                                <div class="image-text_9 flex-row justify-between">
                                    <img class="image_7"
                                         referrerpolicy="no-referrer"
                                         src="./img/SketchPngf26d5eaaaaef810a66edefaf4d1b092fa6902e337a61e075a9ae1393ccb8bb45.png" />
                                    <div class="text-group_9 flex-col justify-between">
                                        <span class="text_199">阈值</span>
                                        <span class="text_19" id="current_peak"></span>
                                        <span class="text_20">峰值最大值</span>
                                    </div>
                                </div>
                                <span class="text_21" id="resCurrentBaseDecimal"></span>
                                <span class="text_22" id="resCurrentPeakDecimal"></span>
                            </div>
                            <div class="text-wrapper_13 flex-row justify-between">
                                <span class="text_23">电流基值</span>
                                <span class="text_24">电流峰值</span>
                            </div>
                        </div>

                        <div id="hengliuCurrent">
                            <div class="group_399 flex-row">
                                <div class="image-text_8 flex-row justify-between">
                                    <div class="text-group_1299 flex-col justify-between">
                                        <span class="text_12399">阈值</span>
                                        <span class="text_1199" id="current_min"></span>
                                        <span class="text_1299">最小值</span>
                                    </div>
                                    <img class="image_599"
                                         referrerpolicy="no-referrer"
                                         src="./img/SketchPngf26d5eaaaaef810a66edefaf4d1b092fa6902e337a61e075a9ae1393ccb8bb45.png" />
                                </div>
                                <span class="text_1399">888</span>
                                <span class="text_1499" id="reshengliuAinteger"></span>
                                <span class="text_1599" id="">.8</span>
                                <div class="image-text_1399 flex-row justify-between">
                                    <img class="image_699"
                                         referrerpolicy="no-referrer"
                                         src="./img/SketchPngf26d5eaaaaef810a66edefaf4d1b092fa6902e337a61e075a9ae1393ccb8bb45.png" />
                                    <div class="text-group_1399 flex-col justify-between">
                                        <span class="text_12399">阈值</span>
                                        <span class="text_1699" id="current_max"></span>
                                        <span class="text_1799" >最大值</span>
                                    </div>
                                </div>
                                <span class="text_1899" id="reshengliuAintegerDecimal"></span>
                            </div>
                            <span class="text_1999">实时电流</span>
                        </div>
                        <!------------------------------------------------------------>

                        <img class="image_8"
                             referrerpolicy="no-referrer"
                             src="./img/SketchPngdd0def474b8787fed9eac5b3c5c1940ab6794d809ba42ab419ed4b9d2edc2d96.png" />
                        <img class="label_3"
                             referrerpolicy="no-referrer"
                             src="./img/SketchPng6705af63a0d717ff43dd6a6ea321de943eecd49c00551c675ab2b014cc0334d5.png" />

                        <!------------------------------------------------------------>

                        <div id="maichongVoltage">
                            <div class="group_18 flex-row">
                                <div class="image-text_10 flex-row justify-between">
                                    <div class="text-group_10 flex-col justify-between">
                                        <span class="text_111">阈值</span>
                                        <span class="text_25" id="voltage_base"></span>
                                        <span class="text_12">基值最小值</span>
                                    </div>
                                    <img class="image_9"
                                         referrerpolicy="no-referrer"
                                         src="./img/SketchPngf26d5eaaaaef810a66edefaf4d1b092fa6902e337a61e075a9ae1393ccb8bb45.png" />
                                </div>
                                <span class="text_27">888</span>
                                <span class="text_28" id="resVoltageBaseInteger"></span>
                                <span class="text_29">.8</span>
                                <img class="image_10"
                                     referrerpolicy="no-referrer"
                                     src="./img/SketchPngb46fc42ad5a5468d22aac004395ddb608cbb2a5eb3e78ad02c0887e3b9a9d09a.png" />
                                <span class="text_30">888</span>
                                <span class="text_36" id="resVoltagePeakInteger"></span>
                                <span class="text_31">.8</span>
                                <div class="image-text_11 flex-row justify-between">
                                    <img class="image_11"
                                         referrerpolicy="no-referrer"
                                         src="./img/SketchPngf26d5eaaaaef810a66edefaf4d1b092fa6902e337a61e075a9ae1393ccb8bb45.png" />
                                    <div class="text-group_11 flex-col justify-between">
                                        <span class="text_199">阈值</span>
                                        <span class="text_32" id="voltage_peak"></span>
                                        <span class="text_33">峰值最大值</span>
                                    </div>
                                </div>
                                <span class="text_34" id="resVoltageBaseDecimal"></span>
                                <span class="text_35" id="resVoltagePeakDecimal"></span>

                            </div>
                            <div class="text-wrapper_14 flex-row justify-between">
                                <span class="text_37">电压基值</span>
                                <span class="text_38">电压峰值</span>
                            </div>
                        </div>

                        <div id="hengliuVoltage">
                            <div class="group_499 flex-row">
                                <div class="image-text_8 flex-row justify-between">
                                    <div class="text-group_1499 flex-col justify-between">
                                        <span class="text_12399">阈值</span>
                                        <span class="text_1199" id="voltage_min"></span>
                                        <span class="text_1299">最小值</span>
                                    </div>
                                    <img class="image_899"
                                         referrerpolicy="no-referrer"
                                         src="./img/SketchPngf26d5eaaaaef810a66edefaf4d1b092fa6902e337a61e075a9ae1393ccb8bb45.png" />
                                </div>
                                <span class="text_2299">888</span>
                                <span class="text_2399" id="reshengliuVinteger"></span>
                                <span class="text_2499">.8</span>
                                <div class="image-text_1599 flex-row justify-between">
                                    <img class="image_999"
                                         referrerpolicy="no-referrer"
                                         src="./img/SketchPngf26d5eaaaaef810a66edefaf4d1b092fa6902e337a61e075a9ae1393ccb8bb45.png" />
                                    <div class="text-group_1599 flex-col justify-between">
                                        <span class="text_12399">阈值</span>
                                        <span class="text_2599" id="voltage_max"></span>
                                        <span class="text_2699">最大值</span>
                                    </div>
                                </div>
                                <span class="text_2799" id="reshengliuVintegerDecimal"></span>
                            </div>
                            <span class="text_2899">实时电压</span>
                        </div>
                    </div>
                    <!------------------------------------------------------------>

                    <div class="box_2 flex-col">
                        <div id="_task">
                            <div class="group_42 flex-row justify-between" id="_alert" hidden="hidden">
                                <img class="label_12"
                                     referrerpolicy="no-referrer"
                                     src="./img/SketchPng9a7b841108005e28073e391f538c20e35a538340d6f3ef4772d07398eedaf5af.png" />
                                <span class="text_82">当前识别的焊接模式与任务中的焊接模式不一致</span>
                            </div>

                            <div class="box_499 flex-col">
                                <div class="section_1099 flex-row justify-end">
                                    <div class="block_199 flex-col">
                                        <img class="thumbnail_1299"
                                             referrerpolicy="no-referrer"
                                             src="./img/SketchPng7ccc5a0312a723a005baa1dadce2154967c91e70918418132d86f2e85c720f98.png" />
                                        <div class="group_1799 flex-col"></div>
                                        <div class="group_1899 flex-col"></div>
                                        <img class="label_599"
                                             referrerpolicy="no-referrer"
                                             src="./img/SketchPngcc7ff540daa4cb5ff92e5a378fb5c526b567b0bc9c575f9192b26c9cd61edeb6.png" />
                                    </div>
                                    <span class="text_3999">焊接任务</span>
                                    <div class="text-wrapper_599 flex-col">
                                        <span class="text_4099">进行中</span>
                                    </div>
                                </div>
                                <div class="box_799 flex-col"></div>
                                <div class="section_1199 flex-row justify-between">
                                    <div class="image-text_1499 flex-row justify-between">
                                        <img class="thumbnail_1399"
                                             referrerpolicy="no-referrer"
                                             src="./img/SketchPngb091b9fa66941ff6d3ce971763d383a72a35e027a4f4cad5075b170bc5e3cf31.png" />
                                        <span class="text-group_599">流转卡号:</span>
                                    </div>
                                    <span class="text_4199" id="st_no"></span>
                                </div>
                                <div class="section_1299 flex-row justify-between">
                                    <div class="image-text_15999 flex-row justify-between">
                                        <img class="thumbnail_1499"
                                             referrerpolicy="no-referrer"
                                             src="./img/SketchPng7f6ba0a866d95c78573e72db0bb0665630337426276760180f15c638d4d27e53.png" />
                                        <span class="text-group_699">工序号:</span>
                                    </div>
                                    <span class="text_4299" id="op_no"></span>
                                </div>
                                <div class="section_1399 flex-row justify-between">
                                    <div class="image-text_1699 flex-row justify-between">
                                        <img class="thumbnail_1599"
                                             referrerpolicy="no-referrer"
                                             src="./img/SketchPngb8646c2586a0d3dc37e2816905a20896ebc4d49285e3cef9abe87c3aad8e4203.png" />
                                        <span class="text-group_799">工序内容:</span>
                                    </div>
                                    <span class="text_4399" id="op_content"></span>
                                </div>
                                <div class="section_1499 flex-row justify-between">
                                    <div class="image-text_1799 flex-row justify-between">
                                        <img class="thumbnail_1699"
                                             referrerpolicy="no-referrer"
                                             src="./img/SketchPngb8646c2586a0d3dc37e2816905a20896ebc4d49285e3cef9abe87c3aad8e4203.png" />
                                        <span class="text-group_899">工序备注:</span>
                                    </div>
                                    <span class="text_4499" id="op_remarks"></span>
                                </div>
                                <div class="image-text_18 flex-col justify-between">
                                    <div class="box_12 flex-col">
                                        <div class="box_13 flex-row">
                                            <div class="text-group_32 flex-col justify-between">
                                                <span class="text_66">焊缝代号</span>
                                                <span class="text_67" id="weld_code"></span>
                                            </div>
                                            <div class="text-group_33 flex-col justify-between">
                                                <span class="text_68">焊缝类型</span>
                                                <span class="text_69" id="weld_type"></span>
                                            </div>
                                            <div class="text-group_34 flex-col justify-between">
                                                <span class="text_70">人员类型</span>
                                                <span class="text_71" id="operator_type"></span>
                                            </div>
                                        </div>
                                        <div class="box_14 flex-row">
                                            <div class="text-group_38 flex-col justify-between">
                                                <span class="text_72">工作令号</span>
                                                <span class="text_73" id="wo_no"></span>
                                            </div>
                                            <div class="text-group_39 flex-col justify-between">
                                                <span class="text_74">WPS编号</span>
                                                <span class="text_75" id="wps_code"></span>
                                            </div>
                                            <div class="text-group_40 flex-col justify-between">
                                                <span class="text_76">班次</span>
                                                <span class="text_77" id="classes"></span>
                                            </div>
                                        </div>
                                        <div class="box_15 flex-row">
                                            <div class="text-group_44 flex-col justify-between">
                                                <span class="text_78">任务分类</span>
                                                <span class="text_79" id="task_sort"></span>
                                            </div>
                                            <div class="text-group_45 flex-col justify-between">
                                                <span class="text_80">焊接方法</span>
                                                <span class="text_81" id="weld_method"></span>
                                            </div>
                                            <div class="text-group_45 flex-col justify-between">
                                                <span class="text_85">焊层/道</span>
                                                <span class="text_86" id="weld_layer"></span>
                                            </div>
                                        </div>
                                        <div class="box_16 flex-row">
                                            <div class="text-group_48 flex-col justify-between">
                                                <span class="text_82">备注</span>
                                                <span class="text_83" id="remarks"></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="text-group_50 flex-row justify-between">
                                        <span class="text_6399">任务创建:</span>
                                        <span class="text_6399" id="task_create_time"></span>
                                        <span class="text_84">任务更新:</span>
                                        <span class="text_84" id="task_updte_time"></span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!------------------------------------------------------------>

                        <div id="_tasknone">
                            <img class="image_15"
                                 referrerpolicy="no-referrer"
                                 src="./img/SketchPng290cb5f08fda14d022e1b3871efb47153ca35c451ae6179dfba45ff9055ccbd7.png" />
                            <span class="text_45">暂无任务</span>
                        </div>
                    </div>

                    <!------------------------------------------------------------>
                </div>
                <div class="text-wrapper_19 flex-row">
                    <span class="text_54">东方电气（广州）重型机器有限公司</span>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
